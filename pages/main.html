<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../assets/styles/main.css" type="text/css" rel="stylesheet">
    <title>메인 페이지</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="icon" href="../assets/images/favicon.svg">
</head>

<body>
    <div id="header"></div>

    <!-- 인트로 -->
    <div id="intro" class="container d-flex justify-content-center mt-3">
        <div class="main-content w-50">
            <div class="p-3 mb-2 text-center rounded-5 shadow-lg"
                style="background-color: #FADADD; border-radius: 20px !important;">
                <div class="container-fluid py-3">
                    <h1 class="display-5 fw-bold">WE ARE HELMET JO</h1>
                    <p class="col-md-8 mx-auto fs-5">
                        Our team has chosen the slogan "We Charge Forward."
                        No matter what challenges come our way, the five of us will tackle them head-on with our
                        helmets.
                        We are ready to take on any challenge. Thank you! 🚀💪💪💪💪💪
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- 소개 -->
    <div id="helmet" class="container w-75 mt-4">
        <div class="row row-cols-1 row-cols-md-3 g-4">
            <div class="col align-self-stretch">
                <h3 class="text-center">Our Team Rules</h3>
                <div class="card h-100 shadow-lg" style="background-color: #f7e4e5;">
                    <div class="card-body">
                        <h5 class="card-title text-center">우리팀 규칙</h5>
                        <p class="card-text text-start">
                            ⏰ 시간 약속 지키기!<br>
                            💬 소통과 공유하기!<br>
                            🤝 문제 해결에 집중하기!<br>
                            🖥️ 협업을 위해 화면 공유하기!<br>
                            💪 건피는 필수입니다.<br>
                            📅 스크럼 시간 <br>
                            ⏰ 오전 9시, 오후 2시, 오후 8시 30분을 반드시 지키겠습니다.<br>
                            📢 스크럼 미참여 시 반드시 미리 알려주겠습니다.
                        </p>
                    </div>
                </div>
            </div>
            <div class="col align-self-stretch">
                <h3 class="text-center">TMI</h3>
                <div class="card h-100 shadow-lg p-3" style="background-color: #f7e4e5;">
                    <div class="row">
                        <div class="col-6">
                            <img src="../assets/images/tmi/dog1.png" class="card-img-top w-100" alt="...">
                        </div>
                        <div class="col-6">
                            <img src="../assets/images/tmi/dog2.png" class="card-img-top w-100" alt="...">
                        </div>
                        <div class="col-12 text-center">
                            <img src="../assets/images/tmi/minha.png" class="card-img-top w-50" alt="...">
                        </div>
                        <div class="col-6">
                            <img src="../assets/images/tmi/yang1.png" class="card-img-top w-100" alt="...">
                        </div>
                        <div class="col-6">
                            <img src="../assets/images/tmi/yang2.png" class="card-img-top w-100" alt="...">
                        </div>
                        <div class="col-6">
                            <img src="../assets/images/tmi/yang3.png" class="card-img-top w-100" alt="...">
                        </div>
                        <div class="col-6">
                            <img src="../assets/images/tmi/yang4.png" class="card-img-top w-100" alt="...">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col align-self-stretch">
                <h3 class="text-center">Ultimate Goal</h3>
                <div class="card h-100 shadow-lg" style="background-color: #f7e4e5;">
                    <div class="card-body">
                        <h5 class="card-title text-center">복 무 신 조</h5>
                        <p class="card-text">
                            📆 하나. 매일 일정 소화하려고 노력하겠습니다.<br>
                            🙋‍♂️ 둘. 부끄러워도 물어보려고 노력하겠습니다. <br>
                            📝 셋. TIL 매일 쓰도록 노력하겠습니다. <br>
                            🎯 넷. 수료까지 화이팅하겠습니다.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 멤버 카드 -->
    <div class="container" id="memberCard">
        <div class="row row-cols-1 row-cols-md-5 g-4 justify-content-center"></div>
    </div>

    <div id="footer"></div>

    <!-- JavaScript 코드는 BODY 맨 아래에 배치 -->
    <script type="module">
        import { app, db, collection, getDocs, query, orderBy } from '../assets/js/firebase-config.js';

        (async () => {
            const q = query(collection(db, "member"), orderBy("reg_dt", "desc"));
            const docs = await getDocs(q);

            if (docs.size == 0) {
                const html = `
                    <div class="text-center p-5">
                        <p>등록된 멤버가 없습니다.</p>
                    </div>`;
                document.querySelector('#memberCard .row').innerHTML = html;
            } else {
                docs.forEach((doc) => {
                    let row = doc.data();

                    const html = `
<<<<<<< Updated upstream
                        <div class="col member-card" data-id=${doc.id}>
=======
                        <div class="col" id="memberCard"data-id=${doc.id}>
>>>>>>> Stashed changes
                            <div class="card h-100 text-center shadow-lg p-3 bg-light rounded-4">
                                <img src="${row['img']}" class="rounded-circle mx-auto mt-3" alt="${row['name']}">
                                <div class="card-body">
                                    <h5 class="card-title">${row['name']}</h5>
                                    <p class="card-text">${row['mbti']}</p>
<<<<<<< Updated upstream
                                    <p class="text-muted">${row['blog'] ? `
                                        <a href="${row['blog']}" target="_blank" onclick="event.stopPropagation()">BLOG</a>` : 'BLOG 없음'}
                                    </p>
=======
                                    <p class="text-muted">${row['blog'] ? `<a href="${row['blog']}" target="_blank">BLOG</a>` : 'BLOG 없음'}</p>
>>>>>>> Stashed changes
                                    <p class="text-muted">${row['contact'] || '전화번호 없음'}</p>
                                    <p class="text-muted">${row['email'] || '이메일 없음'}</p>
                                </div>
                            </div>
                        </div>`;

                    document.querySelector('#memberCard .row').insertAdjacentHTML('beforeend', html);
                });

                // 멤버 카드 클릭 시 해당 페이지로 이동
                document.querySelectorAll('.member-card').forEach(card => {
                    card.addEventListener('click', function () {
                        const memberId = this.dataset.id;
                        location.href = `/pages/memberCard.html?id=${memberId}`;
                    });
                });

                // 멤버 카드 클릭 시 해당 페이지로 이동
                document.querySelectorAll('#memberCard').forEach(card => {
                    card.addEventListener('click', function () {
                        const memberId = this.dataset.id;
                        location.href = `/pages/memberCard.html?id=${memberId}`;
                    });
                });
            }

            // 멤버 로딩 끝나면 scroll
            scrollToHashElement();
        })();

        // scroll 함수
        function scrollToHashElement() {
            if (location.hash) {
                const target = document.querySelector(location.hash);
                if (target) {
                    const headerOffset = 55;
                    const elementPosition = target.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.scrollY - headerOffset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: "smooth"
                    });
                }
            }
        }
        
        // F5 누르면 새로 로딩
        document.addEventListener('keydown', function (event) {
            if (event.key === 'F5' || event.keyCode === 116) {
                event.preventDefault();
                window.location.href = 'main.html';
            }
        });
    </script>

    <script>
        // Header & Footer 적용
        $(function () {
            $("#header").load("common/header.html");
            $("#footer").load("common/footer.html");
        });
    </script>

</body>

</html>